site_name: Focal Documentation
theme:
  name: material
  logo: logo.svg
  palette:
    # Palette toggle for light vs dark mode
    - scheme: default
      toggle:
        icon: material/brightness-7
        name: Switch to dark mode

    # Palette toggle for dark vs light mode
    - scheme: slate
      toggle:
        icon: material/brightness-4
        name: Switch to light mode
  features:
    - navigation.tabs
    - navigation.sections
    - toc.integrate
    - navigation.top
    - search.suggest
    - search.highlight
    - content.tabs.link
    - content.code.annotation
    - content.code.copy
  language: en

extra_css:
  - stylesheets/extra.css

markdown_extensions:
  - pymdownx.highlight:
      anchor_linenums: true
  - pymdownx.inlinehilite
  - pymdownx.snippets
  - admonition
  - pymdownx.details
  - pymdownx.superfences
  - pymdownx.mark
  - attr_list
  - pymdownx.emoji:
      emoji_index: !!python/name:material.extensions.emoji.twemoji
      emoji_generator: !!python/name:material.extensions.emoji.to_svg

nav:
  - Home: index.md
  - Project Documentation:
    - Vision: project_docs/vision.md
    - Skeleton: project_docs/doc_skeleton.md
    - Architecture:
      - Alignment Engine: project_docs/architecture/alignment-engine.md
      - API Layer: project_docs/architecture/api-layer.md
      - Configuration: project_docs/architecture/configuration.md
      - Configuration Models: project_docs/architecture/configuration-models.md
      - Configuration Overview: project_docs/architecture/configuration-overview.md
      - Configuration Secrets: project_docs/architecture/configuration-secrets.md
      - Configuration TOML: project_docs/architecture/configuration-toml.md
      - Configuration Usage Validation: project_docs/architecture/configuration-usage-validation.md
      - Folder Structure: project_docs/architecture/folder-structure.md
      - Kernel Agent Integration: project_docs/architecture/kernel-agent-integration.md
      - Memory Layer: project_docs/architecture/memory-layer.md
      - Observability: project_docs/architecture/observability.md
      - Overview: project_docs/architecture/overview.md
      - Selection Strategies: project_docs/architecture/selection-strategies.md
    - Design:
      - API CRUD: project_docs/design/api-crud.md
      - Customer Profile: project_docs/design/customer-profile.md
      - Domain Model: project_docs/design/domain-model.md
      - Scenario Update Methods: project_docs/design/scenario-update-methods.md
      - Turn Pipeline: project_docs/design/turn-pipeline.md
      - Decisions:
        - 001 Storage Choice: project_docs/design/decisions/001-storage-choice.md
        - 002 Rule Matching Strategy: project_docs/design/decisions/002-rule-matching-strategy.md
    - Development:
      - Testing Strategy: project_docs/development/testing-strategy.md
      - Unit Testing: project_docs/development/unit-testing.md
  - Specifications:
    - 001 Project Foundation:
      - Checklist: project_specs/001-project-foundation/checklists/requirements.md
      - Data Model: project_specs/001-project-foundation/data-model.md
      - Plan: project_specs/001-project-foundation/plan.md
      - Quickstart: project_specs/001-project-foundation/quickstart.md
      - Research: project_specs/001-project-foundation/research.md
      - Spec: project_specs/001-project-foundation/spec.md
      - Tasks: project_specs/001-project-foundation/tasks.md
    - 002 Configuration System:
      - Checklist: project_specs/002-configuration-system/checklists/requirements.md
      - Spec: project_specs/002-configuration-system/spec.md
    - 003 Core Abstractions:
      - Checklist: project_specs/003-core-abstractions/checklists/requirements.md
      - Contracts:
        - Observability: project_specs/003-core-abstractions/contracts/observability.md
        - Providers: project_specs/003-core-abstractions/contracts/providers.md
        - Stores: project_specs/003-core-abstractions/contracts/stores.md
      - Data Model: project_specs/003-core-abstractions/data-model.md
      - Plan: project_specs/003-core-abstractions/plan.md
      - Quickstart: project_specs/003-core-abstractions/quickstart.md
      - Research: project_specs/003-core-abstractions/research.md
      - Spec: project_specs/003-core-abstractions/spec.md
      - Tasks: project_specs/003-core-abstractions/tasks.md
    - 004 Alignment Pipeline:
      - Checklist: project_specs/004-alignment-pipeline/checklists/requirements.md
      - Data Model: project_specs/004-alignment-pipeline/data-model.md
      - Plan: project_specs/004-alignment-pipeline/plan.md
      - Quickstart: project_specs/004-alignment-pipeline/quickstart.md
      - Research: project_specs/004-alignment-pipeline/research.md
      - Spec: project_specs/004-alignment-pipeline/spec.md
      - Tasks: project_specs/004-alignment-pipeline/tasks.md
    - 005 Memory Ingestion:
      - Contracts:
        - Service Interfaces: project_specs/005-memory-ingestion/contracts/service-interfaces.md
      - Data Model: project_specs/005-memory-ingestion/data-model.md
      - Plan: project_specs/005-memory-ingestion/plan.md
      - Quickstart: project_specs/005-memory-ingestion/quickstart.md
      - Research: project_specs/005-memory-ingestion/research.md
      - Spec: project_specs/005-memory-ingestion/spec.md
      - Tasks: project_specs/005-memory-ingestion/tasks.md
    - 006 API Layer Core:
      - Checklist: project_specs/006-api-layer-core/checklists/requirements.md
      - Data Model: project_specs/006-api-layer-core/data-model.md
      - Plan: project_specs/006-api-layer-core/plan.md
      - Quickstart: project_specs/006-api-layer-core/quickstart.md
      - Research: project_specs/006-api-layer-core/research.md
      - Spec: project_specs/006-api-layer-core/spec.md
      - Tasks: project_specs/006-api-layer-core/tasks.md
    - 007 API Layer CRUD:
      - Checklist: project_specs/007-api-layer-crud/checklists/requirements.md
      - Data Model: project_specs/007-api-layer-crud/data-model.md
      - Plan: project_specs/007-api-layer-crud/plan.md
      - Quickstart: project_specs/007-api-layer-crud/quickstart.md
      - Research: project_specs/007-api-layer-crud/research.md
      - Spec: project_specs/007-api-layer-crud/spec.md
      - Tasks: project_specs/007-api-layer-crud/tasks.md
    - 008 Scenario Migration:
      - Checklist: project_specs/008-scenario-migration/checklists/requirements.md
      - Data Model: project_specs/008-scenario-migration/data-model.md
      - Plan: project_specs/008-scenario-migration/plan.md
      - Quickstart: project_specs/008-scenario-migration/quickstart.md
      - Research: project_specs/008-scenario-migration/research.md
      - Spec: project_specs/008-scenario-migration/spec.md
      - Tasks: project_specs/008-scenario-migration/tasks.md
    - 009 Production Stores Providers:
      - Checklist: project_specs/009-production-stores-providers/checklists/requirements.md
      - Plan: project_specs/009-production-stores-providers/plan.md
      - Spec: project_specs/009-production-stores-providers/spec.md
  - API Reference:
    - Alignment:
      - Core:
        - Engine: reference/focal.alignment.engine.md
        - Result: reference/focal.alignment.result.md
        - Templates Loader: reference/focal.alignment.templates_loader.md
      - Context:
        - Extractor: reference/focal.alignment.context.extractor.md
        - Models: reference/focal.alignment.context.models.md
      - Enforcement:
        - Fallback: reference/focal.alignment.enforcement.fallback.md
        - Models: reference/focal.alignment.enforcement.models.md
        - Validator: reference/focal.alignment.enforcement.validator.md
      - Execution:
        - Models: reference/focal.alignment.execution.models.md
        - Tool Executor: reference/focal.alignment.execution.tool_executor.md
        - Variable Resolver: reference/focal.alignment.execution.variable_resolver.md
      - Filtering:
        - Models: reference/focal.alignment.filtering.models.md
        - Rule Filter: reference/focal.alignment.filtering.rule_filter.md
        - Scenario Filter: reference/focal.alignment.filtering.scenario_filter.md
      - Generation:
        - Generator: reference/focal.alignment.generation.generator.md
        - Models: reference/focal.alignment.generation.models.md
        - Prompt Builder: reference/focal.alignment.generation.prompt_builder.md
      - Migration:
        - Composite: reference/focal.alignment.migration.composite.md
        - Diff: reference/focal.alignment.migration.diff.md
        - Executor: reference/focal.alignment.migration.executor.md
        - Gap Fill: reference/focal.alignment.migration.gap_fill.md
        - Models: reference/focal.alignment.migration.models.md
        - Planner: reference/focal.alignment.migration.planner.md
      - Models:
        - Agent: reference/focal.alignment.models.agent.md
        - Base: reference/focal.alignment.models.base.md
        - Context: reference/focal.alignment.models.context.md
        - Enums: reference/focal.alignment.models.enums.md
        - Publish: reference/focal.alignment.models.publish.md
        - Rule: reference/focal.alignment.models.rule.md
        - Scenario: reference/focal.alignment.models.scenario.md
        - Template: reference/focal.alignment.models.template.md
        - Tool Activation: reference/focal.alignment.models.tool_activation.md
        - Variable: reference/focal.alignment.models.variable.md
      - Retrieval:
        - Models: reference/focal.alignment.retrieval.models.md
        - Reranker: reference/focal.alignment.retrieval.reranker.md
        - Rule Retriever: reference/focal.alignment.retrieval.rule_retriever.md
        - Scenario Retriever: reference/focal.alignment.retrieval.scenario_retriever.md
        - Selection: reference/focal.alignment.retrieval.selection.md
      - Stores:
        - Config Store: reference/focal.alignment.stores.config_store.md
        - In-Memory: reference/focal.alignment.stores.inmemory.md
    - API:
      - Core:
        - App: reference/focal.api.app.md
        - Dependencies: reference/focal.api.dependencies.md
        - Exceptions: reference/focal.api.exceptions.md
      - gRPC:
        - Server: reference/focal.api.grpc.server.md
      - Middleware:
        - Auth: reference/focal.api.middleware.auth.md
        - Context: reference/focal.api.middleware.context.md
        - Idempotency: reference/focal.api.middleware.idempotency.md
        - Rate Limit: reference/focal.api.middleware.rate_limit.md
      - Models:
        - Bulk: reference/focal.api.models.bulk.md
        - Chat: reference/focal.api.models.chat.md
        - Context: reference/focal.api.models.context.md
        - CRUD: reference/focal.api.models.crud.md
        - Errors: reference/focal.api.models.errors.md
        - Health: reference/focal.api.models.health.md
        - Pagination: reference/focal.api.models.pagination.md
        - Session: reference/focal.api.models.session.md
      - Routes:
        - Agents: reference/focal.api.routes.agents.md
        - Chat: reference/focal.api.routes.chat.md
        - Config: reference/focal.api.routes.config.md
        - Health: reference/focal.api.routes.health.md
        - Migrations: reference/focal.api.routes.migrations.md
        - Publish: reference/focal.api.routes.publish.md
        - Rules: reference/focal.api.routes.rules.md
        - Scenarios: reference/focal.api.routes.scenarios.md
        - Sessions: reference/focal.api.routes.sessions.md
        - Templates: reference/focal.api.routes.templates.md
        - Tools: reference/focal.api.routes.tools.md
        - Variables: reference/focal.api.routes.variables.md
      - Services:
        - Embedding: reference/focal.api.services.embedding.md
        - Publish: reference/focal.api.services.publish.md
        - Scenario Validation: reference/focal.api.services.scenario_validation.md
    - Audit:
      - Models:
        - Event: reference/focal.audit.models.event.md
        - Turn Record: reference/focal.audit.models.turn_record.md
      - Store: reference/focal.audit.store.md
      - Stores:
        - ClickHouse: reference/focal.audit.stores.clickhouse.md
        - In-Memory: reference/focal.audit.stores.inmemory.md
        - MongoDB: reference/focal.audit.stores.mongodb.md
        - PostgreSQL: reference/focal.audit.stores.postgres.md
        - Timescale: reference/focal.audit.stores.timescale.md
    - Config:
      - Core:
        - Loader: reference/focal.config.loader.md
        - Settings: reference/focal.config.settings.md
      - Models:
        - Agent: reference/focal.config.models.agent.md
        - API: reference/focal.config.models.api.md
        - Migration: reference/focal.config.models.migration.md
        - Observability: reference/focal.config.models.observability.md
        - Pipeline: reference/focal.config.models.pipeline.md
        - Providers: reference/focal.config.models.providers.md
        - Selection: reference/focal.config.models.selection.md
        - Storage: reference/focal.config.models.storage.md
    - Conversation:
      - Core:
        - Store: reference/focal.conversation.store.md
      - Models:
        - Enums: reference/focal.conversation.models.enums.md
        - Session: reference/focal.conversation.models.session.md
        - Turn: reference/focal.conversation.models.turn.md
      - Stores:
        - DynamoDB: reference/focal.conversation.stores.dynamodb.md
        - In-Memory: reference/focal.conversation.stores.inmemory.md
        - MongoDB: reference/focal.conversation.stores.mongodb.md
        - Redis: reference/focal.conversation.stores.redis.md
    - Memory:
      - Core:
        - Store: reference/focal.memory.store.md
      - Ingestion:
        - Entity Extractor: reference/focal.memory.ingestion.entity_extractor.md
        - Errors: reference/focal.memory.ingestion.errors.md
        - Ingestor: reference/focal.memory.ingestion.ingestor.md
        - Models: reference/focal.memory.ingestion.models.md
        - Queue: reference/focal.memory.ingestion.queue.md
        - Summarizer: reference/focal.memory.ingestion.summarizer.md
        - Tasks: reference/focal.memory.ingestion.tasks.md
      - Models:
        - Entity: reference/focal.memory.models.entity.md
        - Episode: reference/focal.memory.models.episode.md
        - Relationship: reference/focal.memory.models.relationship.md
      - Retrieval:
        - Reranker: reference/focal.memory.retrieval.reranker.md
        - Retriever: reference/focal.memory.retrieval.retriever.md
      - Stores:
        - In-Memory: reference/focal.memory.stores.inmemory.md
        - MongoDB: reference/focal.memory.stores.mongodb.md
        - Neo4j: reference/focal.memory.stores.neo4j.md
        - PostgreSQL: reference/focal.memory.stores.postgres.md
    - Observability:
      - Core:
        - Logging: reference/focal.observability.logging.md
        - Metrics: reference/focal.observability.metrics.md
        - Middleware: reference/focal.observability.middleware.md
        - Tracing: reference/focal.observability.tracing.md
    - Profile:
      - Core:
        - Enums: reference/focal.profile.enums.md
        - Models: reference/focal.profile.models.md
        - Store: reference/focal.profile.store.md
      - Stores:
        - In-Memory: reference/focal.profile.stores.inmemory.md
    - Providers:
      - Embedding:
        - Base: reference/focal.providers.embedding.base.md
        - Cohere: reference/focal.providers.embedding.cohere.md
        - Mock: reference/focal.providers.embedding.mock.md
        - OpenAI: reference/focal.providers.embedding.openai.md
        - Sentence Transformers: reference/focal.providers.embedding.sentence_transformers.md
        - Voyage: reference/focal.providers.embedding.voyage.md
      - LLM:
        - Anthropic: reference/focal.providers.llm.anthropic.md
        - Base: reference/focal.providers.llm.base.md
        - Bedrock: reference/focal.providers.llm.bedrock.md
        - Mock: reference/focal.providers.llm.mock.md
        - Ollama: reference/focal.providers.llm.ollama.md
        - OpenAI: reference/focal.providers.llm.openai.md
        - Vertex: reference/focal.providers.llm.vertex.md
      - Rerank:
        - Base: reference/focal.providers.rerank.base.md
        - Cohere: reference/focal.providers.rerank.cohere.md
        - Cross-Encoder: reference/focal.providers.rerank.cross_encoder.md
        - Mock: reference/focal.providers.rerank.mock.md
        - Voyage: reference/focal.providers.rerank.voyage.md
    - Utils:
      - Vector: reference/focal.utils.vector.md